---
title: Testing
pageTitle: WunderGraph - Testing
description: This guide shows how to test your WunderGraph applications
---

## Headless testing

WunderGraph comes with builtin support for running tests against your APIs, using a our type-safe
TypeScript client. Our `Server` implementation sets up your WunderGraph server, runs your tests,
and finally tears everything down.

Our testing library is framework agnostic, so you can use it coupled with your preferred test
framework. We use both [Jest](https://jestjs.io) and [ava](https://github.com/avajs/ava) for
these examples, but they should be easily adaptable to any testing framework.

### Initial setup

Make sure your `wundergraph.config.ts` is set up to generate the WunderGraph TypeScript client:

```typescript

configureWunderGraphApplication({
	apis: [
        ...
	],
	server,
	operations,
	codeGenerators: [
		{
			templates: [
				// Generate all TypeScript based templates, which includes the client
				...templates.typescript.all,
            ],
        }
});
```

Within a test, you can use `Server.client()` to retrieve a TypeScript WunderGraph client instance ready
to query the server set up by the testing library.

### Testing with Jest

Create your test file and import both `Server` from `@wundergraph/sdk/testing` and `createClient` from
the file generated by WunderGraph:

```typescript
import { Server } from '@wundergraph/sdk/testing'
import { createClient } from '../.wundergraph/generated/client'

// Imports from Jest
import { describe, expect, test } from '@jest/globals'
```

You can create as many `Server` instances as you like, they will run in parallel without interfering
with each other, but to make your tests as fast as possible we recommend creating a single instance
per file.

```typescript
const wg = new Server({ createClient })
```

Finally, define your tests as a Jest test function but wrapped with `wg.test()`. This will take care
of automatically setting up and tearing down the server.

```typescript
test(
  'country by code',
  // Wrap your function with wg.test()
  wg.test(async () => {
    // Use the TypeScript client to perform queries or mutations against your API
    const result = await wg.client().query({
      operationName: 'Countries',
      input: {
        filter: {
          code: { eq: 'AD' },
        },
      },
    })
    const andorra = result.data?.countries_countries[0]
    // Use Jest for assertions
    expect(andorra?.name).toBe('Andorra')
  })
)
```

If you prefer to start and stop the server with Jest instead of relying on the automatic
management by the library, use Jest's `beforeAll()` and `afterAll()`, the you don't need
to wrap your test functions with `wg.test()`:

```typescript
beforeAll(async () => {
  await wg.spinUp()
})

afterAll(async () => {
  await wg.tearDown()
})

test('continents', async () => {
  const result = await wg.client().query({
    operationName: 'Continents',
  })
  expect(result.data?.countries_continents.length).toBe(7)
})
```

If you'd like to see a full example using Jest for testing, check our [simple example](https://github.com/wundergraph/wundergraph/tree/main/examples/simple).

### Testing with Ava

Create your test file and import both `Server` from `@wundergraph/sdk/testing` and `createClient` from
the file generated by WunderGraph:

```typescript
import { Server } from '@wundergraph/sdk/testing'
import { createClient } from '../.wundergraph/generated/client'

// Imports from Ava
import { test } from 'ava'
```

You can create as many `Server` instances as you like, they will run in parallel without interfering
with each other, but to make your tests as fast as possible we recommend creating a single instance
per file.

```typescript
const wg = new Server({ createClient })
```

Use Ava's setup and teardown functions to setup our testing server:

```typescript
test.before(async (t) => {
  await wg.spinUp()
})

test.after(async (t) => {
  await wg.tearDown()
})
```

Finally, define your functions:

```typescript
test('create a note', async (t) => {
  // Use the TypeScript client to perform queries or mutations against your API
  const result = await wg.client().mutate({
    operationName: 'NewNote',
    input: {
      text: 'my first note',
    },
  })
  // Use Ava for assertions
  t.falsy(result.error)
  t.not(
    result.data?.notes_newNote?.id ?? 0,
    0,
    'new note id should not be zero'
  )
})
```

For an example using Ava for testing, check our [openapi-mocking example](https://github.com/wundergraph/wundergraph/tree/main/examples).
